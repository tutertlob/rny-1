# rny-1
このプロジェクトはカメラを使いポストや冷蔵庫など中を遠隔から確認できるようにします。

## うれしいこと
* （特にマンション住まい人とか）ポストを確認しに行ったら、期待したものが届いてなかったりチラシばっかりだったときのがっかり感を防げる。
* Amazonでポチった郵便送付の品物が投函されるとわくわくする。
* 大抵チラシばっかりなのでポストの確認をほっときがちな人で、たまにポストを確認したら大事な郵便物の配達不在票が入っていて、見たら保管期限過ぎてて既に送付元に送り返されてたorzを防げる。
* 3pack納豆を買ったらまだ冷蔵庫に沢山あったよorzを防げる。
* お好み焼きを作ったはいいけどソースを切らしてたorzを防げる。あるいはソース切らしてたかもと思って買ったらまだでっかいソースが冷蔵庫の奥に鎮座してた感を防げる。

## 対象者
"うれしいこと"にどれか一つでも共感を覚えたり興味を持って頂けた方よろしければ試してみてやってください。

## どうやってやってるの？
Arduinoでも制御可能な（余り小さくない）小型カメラと開閉（リード）センサー、特定小電力無線通信モジュールとを使って、郵便物の投函や取り出しをポストに取り付けた開閉センサーで検知すると画像を撮影し（ただしマクロ撮影できずピンボケ）、特定小電力無線でラズパイ（センサーゲートウェイ）側に送信します。ラズパイ側で画像を受信するとDBにイベントを記録し、画像ファイルをストレージに保存し、LINEとかチャットアプリに投函があったことを通知します。最後に通知を受け取ったらスマホからブラウザで画像を確認すると、"うれしいこと"ができるかもしれません。

## システム構成
![システム構成](https://github.com/tutertlob/rny-1/blob/master/Mail%20Box%20Notifier.svg "rny-1システム構成")


* Sender
  </br>カメラ画像を、IM920を使用してRaspberry PI側に送信する。

* Receiver
  </br>Senderから送られたデータをイベントデータとして一次データストア（MongoDB）に保管する。

* Messenger
  </br>データストアからイベントを取出し、Notifier、Passerに要求を送る。応答をRecordKeeperに渡す。

* Notifier
  </br>Messengerからの要求を受信し、LINE等チャットアプリに通知する。結果をMessengerに返す。

* Passer
  </br>Messengerからの要求を受信し、分析用二次データストア(AWS等)にパススルーする。結果をMessengerに返す。

* Record Keeper
  </br>Messengerからの要求を受信し、メッセージの配信状況を一次データストアに更新する。

* Viewer
  </br>通知を受けたユーザからの要求に対し、画像データを返す。

## System installation
Arduino側のハードウェア開発とプログラムインストール、Raspberry Pi側のシステム構築が必要になります。

### Raspberry Pi側
1. Java 8のインストール
2. MongoDBのインストール
3. rny-1のMailbox_senderを除く各構成パッケージのインストール
4. 特定小電力無線モジュールIM920とRaspberry Piの接続
5. チャットアプリアカウント作成とアプリの登録

### Arduino側
1. 部品の調達と半田付け（ハードウェア作成）
2. Mailbox_senderのArduino書き込み
3. USBモバイルバッテリーで駆動させる

